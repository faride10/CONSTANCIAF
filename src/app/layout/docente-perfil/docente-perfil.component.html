<div class="profile-container">
  
  <div class="page-header">
    <h1>Mi Perfil</h1>
    <p>Gestiona tu información personal y seguridad.</p>
  </div>

  <mat-progress-bar mode="indeterminate" *ngIf="isLoading" class="top-progress-bar"></mat-progress-bar>

  <div class="profile-grid">
    
    <mat-card class="profile-card info-card">
      <mat-card-header>
        <div mat-card-avatar class="avatar-placeholder">
          <mat-icon>person</mat-icon>
        </div>
        <mat-card-title>Información Personal</mat-card-title>
        <mat-card-subtitle>Datos generales de tu cuenta docente</mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="infoForm" class="profile-form">
          
          <mat-form-field appearance="outline">
            <mat-label>Nombre Completo</mat-label>
                        <input matInput formControlName="nombre">
            <mat-icon matSuffix>badge</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>RFC (Usuario)</mat-label>
                        <input matInput formControlName="rfc">
            <mat-icon matSuffix>fingerprint</mat-icon>
          </mat-form-field>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Correo Electrónico</mat-label>
                            <input matInput formControlName="correo" placeholder="ejemplo@tecnm.mx">
              <mat-icon matSuffix>email</mat-icon>
                            <mat-error *ngIf="infoForm.get('correo')?.invalid">Correo inválido</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Teléfono</mat-label>
                            <input matInput formControlName="telefono" placeholder="10 dígitos">
              <mat-icon matSuffix>phone</mat-icon>
                            <mat-error *ngIf="infoForm.get('telefono')?.invalid">Solo números (10 dígitos)</mat-error>
            </mat-form-field>
          </div>

        </form>
      </mat-card-content>
      
      <mat-card-actions align="end">
        <button mat-flat-button color="primary" (click)="guardarInfo()" 
                [disabled]="infoForm.invalid || infoForm.pristine || isLoading">
          Guardar Cambios
        </button>
      </mat-card-actions>
    </mat-card>


    <mat-card class="profile-card security-card">
      <mat-card-header>
        <div mat-card-avatar class="avatar-placeholder security-icon">
          <mat-icon>lock</mat-icon>
        </div>
        <mat-card-title>Seguridad</mat-card-title>
        <mat-card-subtitle>Actualizar contraseña</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <form [formGroup]="passwordForm" class="profile-form">
          
          <mat-form-field appearance="outline">
            <mat-label>Contraseña Actual</mat-label>
            <input matInput type="password" formControlName="currentPassword">
          </mat-form-field>

          <mat-divider></mat-divider>
          <br>

          <mat-form-field appearance="outline">
            <mat-label>Nueva Contraseña</mat-label>
            <input matInput type="password" formControlName="newPassword">
            <mat-hint>Mínimo 8 caracteres</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Confirmar Nueva Contraseña</mat-label>
            <input matInput type="password" formControlName="confirmPassword">
          </mat-form-field>

        </form>
      </mat-card-content>

      <mat-card-actions align="end">
        <button mat-stroked-button color="warn" (click)="cambiarPassword()" 
                [disabled]="passwordForm.invalid || isLoading">
          Actualizar Contraseña
        </button>
      </mat-card-actions>
    </mat-card>

  </div>
</div>