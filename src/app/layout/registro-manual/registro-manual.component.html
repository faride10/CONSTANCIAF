<h2 mat-dialog-title>Registrar Asistencia Manualmente</h2>

<mat-dialog-content>
  <p>Selecciona al alumno que deseas registrar en esta conferencia.</p>

  <mat-form-field appearance="outline" class="search-bar">
    <mat-label>Buscar alumno faltante...</mat-label>
    <input 
      matInput 
      [(ngModel)]="terminoBusqueda" 
      (keyup)="filtrarAlumnos()" 
      placeholder="Escribe nombre o num. control">
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <mat-list role="list" class="lista-alumnos">
    <mat-list-item 
      *ngFor="let alumno of alumnosFiltrados"
      (click)="seleccionarAlumno(alumno)"
      [class.seleccionado]="alumno === alumnoSeleccionado"
      role="listitem">
            <div matListItemTitle>{{ alumno.nombre }}</div>
            <div matListItemLine>{{ alumno.num_control }}</div>
    </mat-list-item>
  </mat-list>

  <p *ngIf="alumnosFiltrados.length === 0 && !terminoBusqueda" class="no-alumnos">
    ¡Todos los alumnos del grupo ya están registrados!
  </p>
  <p *ngIf="alumnosFiltrados.length === 0 && terminoBusqueda" class="no-alumnos">
    No se encontraron alumnos con ese término de búsqueda.
  </p>

  <div *ngIf="isLoading" class="spinner-container">
    <mat-spinner diameter="30"></mat-spinner>
    <p>Registrando...</p>
  </div>

</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancelar()">Cancelar</button>
  <button 
    mat-flat-button 
    color="primary" 
    (click)="registrarAsistencia()"
    [disabled]="!alumnoSeleccionado || isLoading">
    Registrar
  </button>
</mat-dialog-actions>